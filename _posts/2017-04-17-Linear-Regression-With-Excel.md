---
title: 엑셀의 분석도구를 이용한 간단한 선형 회귀분석
summary: 머신러닝을 배우기 시작하면 가장 최초로 배우는 분석모델인 선형 회귀분석(Linear Regression)을 별도의 머신러닝 개발환경없이 간단하게 엑셀만을 이용해서 실습해 봅니다. 
---

선형 회귀분석(Linear Regression)은 머신러닝을 공부할때 가장 첫번째 배우는 예측분석 모델입니다. 머신러닝 또는 딥러닝을 배우는 입장에서는 처음에 Python, Tensorflow, Keras, R, Matlab 등의 낯선 학습환경을 본인의 PC에 구성해서 하게 되지만 간단한 선형 회귀분석 정도는 마이크로소프트의 밥줄(....), Office의 Excel에서도 아주 손쉽게 구현하여 결과를 확인하고 분석을 진행할 수 있습니다. 

### 분석도구 활성화

기본적으로 Excel내의 분석도구는 비활성화 되어 있습니다. 이 분석도구를 활성화 시키기 위해서는 Excel의 버전에 따라 다른 방법으로 분석모델을 활성화시켜줘야 합니다. 과거의 Office버전에서는 기본적으로 ``파일메뉴 - 옵션 - (좌측)추가기능메뉴 - 분석도구 - 확인클릭``순으로 분석도구를 활성화할 수 있습니다. 하지만 저는 최신의 Mac용 Office를 사용하기 때문에 다른 경로로 분석도구를 활성화 시켜줘야 합니다. `` (상단)도구 - 추가기능 - 분석기능 체크 - 확인 `` 이렇게 하면 ``데이터``탭 우측 상단에 ``데이터 분석``도구가 있음을 확인할 수 있습니다.

![01]({{ site.baseurl }}/img/2017/0417.01.addAnalysisTool.png)

### 데이터 분석

분석도구를 설치했으니, 이제 선형 회귀분석을 위한 데이터를 로드를 합니다. 우리가 작업할 데이터는 중고차의 가격과 킬로수가 함께 나온 데이터로써, 주행거리(Odometer)와 중고차 가격(Price)간 상관관계를 구하고 이를 예측하기 위해 분석을 진행할 것입니다. 상단의 ``데이터 - 데이터분석``으로 시작합니다. 팝업에 나오는 메뉴중에 ``Regression(회귀분석)``을 선택합니다.

![02]({{ site.baseurl }}/img/2017/0417.02.DataAnalysis.png)

독립변수 X값과 종속변수 Y값에 대해 해당 셀을 Block지정합니다. 그리고 라벨을 체크합니다.

![03]({{ site.baseurl }}/img/2017/0417.03.Regression.png)

데이터의 분석결과가 별도의 시트로 추가가 되며, 우리가 분석한 주행거리별 중고차 가격에 대한 분석은 아래와 같습니다. 중요하게 체크해야할 항목에 녹색표시를 해두었습니다. 

![04]({{ site.baseurl }}/img/2017/0417.04.summary.png)

``R Square(설명력)``의 값은 입력한 X값(주행거리)가 Y값(중고값)을 결정하는데 65%의 영향력을 끼친다는 것을 의미합니다. 또한 하단의 ``Intercept(Y절편)`` 와 Price항목은 선형 회귀분석 모델의 수식인 ``Y = aX + b``를 완성하는데 쓰입니다. 이는 차트를 통해 확인을 하도록 합니다. 

### 차트 추가

차트를 추가하려면 차트버튼을 클릭하면 간단하게 차트를 추가할 수 있습니다.

![04]({{ site.baseurl }}/img/2017/0417.05.AddChart.png)

차트의 데이터를 하나 클릭하여 우클릭을 하면 추세선을 추가할 수 있고, 추세선 서식 옵션의 ``수식을 차트에 표시``를 체크함으로써 분석한 데이터의 선형 회귀분석 모델의 수식을 쉽게 구할 수 있습니다.

![04]({{ site.baseurl }}/img/2017/0417.06.ModifyChartOption.png)

분석된 데이타를 통해 도출된 선형 회귀분석 모델의 공식은 "y = -10.433x + 190655"로 쉽게 확인할 수 있습니다.
